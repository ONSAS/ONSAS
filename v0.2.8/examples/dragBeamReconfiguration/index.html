<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reconfiguration beam · ONSAS.m</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ONSAS.m logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ONSAS.m</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Learning by examples</span><ul><li><a class="tocitem" href="../staticVonMisesTruss/">Static Von-Mises Truss</a></li><li><a class="tocitem" href="../springMass/">Spring-mass system</a></li><li><a class="tocitem" href="../uniaxialExtension/">Uniaxial extension</a></li><li><a class="tocitem" href="../uniaxialCompression/">Uniaxial compression</a></li><li><a class="tocitem" href="../cantileverBeam/">Cantilever Beam</a></li><li><a class="tocitem" href="../beamLinearVibration/">Linear beam vibration</a></li><li><a class="tocitem" href="../ringPlaneStrain/">Plane strain ring</a></li><li class="is-active"><a class="tocitem" href>Reconfiguration beam</a><ul class="internal"><li><a class="tocitem" href="#Dimensionless-analysis"><span>Dimensionless analysis</span></a></li><li><a class="tocitem" href="#Numerical-solution"><span>Numerical solution</span></a></li><li><a class="tocitem" href="#Verification"><span>Verification</span></a></li></ul></li><li><a class="tocitem" href="../simplePropeller/">Propeller model</a></li><li><a class="tocitem" href="../nonLinearAerodynamics/">Non-linear aerodynamics</a></li></ul></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../creatingModels/">Creating Models</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Learning by examples</a></li><li class="is-active"><a href>Reconfiguration beam</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reconfiguration beam</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ONSAS/ONSAS.m/blob/master/docs/src/examples/dragBeamReconfiguration.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Reconfiguration-cantilever-beam-example"><a class="docs-heading-anchor" href="#Reconfiguration-cantilever-beam-example">Reconfiguration cantilever beam example</a><a id="Reconfiguration-cantilever-beam-example-1"></a><a class="docs-heading-anchor-permalink" href="#Reconfiguration-cantilever-beam-example" title="Permalink"></a></h1><p><a href="https://github.com/ONSAS/ONSAS.m/blob/master/examples/dragBeamReconfiguration/dragBeamReconfiguration.m"><img src="https://img.shields.io/badge/script-url-blue" alt="Octave script"/></a></p><p>In this tutorial, a cantilever beam submitted to a flow producing drag forces is considered. The main goal is to validate the drag forces computation considering reconfiguration in a problem with large displacements. The example is based on one of the problems considered in <a href="https://www.cambridge.org/core/journals/journal-of-fluid-mechanics/article/drag-reduction-of-flexible-plates-by-reconfiguration/A3A066DE3886C40B1463508C92D1C81D">this reference</a>, where a reference solution is presented and validated with experimental data. The reference solution was generated with the code publicly available in <a href="https://github.com/lm2-poly/Reconfiguration-Beam/blob/master/reconfiguration.m">this repository</a></p><p>The problem consists in a cantilever beam submitted to a fluid flow with uniform velocity <span>$v_a$</span>(<span>$x$</span>,<span>$t$</span>) = <span>$v_a$</span>(t) <span>$c_2$</span>, as shown int he Figure bellow. The beam is clamped on the boundary at <span>$x=0$</span> m, and the span length is <span>$L$</span>. The cross-section of the beam is circular with diameter <span>$d$</span>. For the material of the beam a linear elastic isotropic model is considered, with Young modulus <span>$E$</span> density <span>$\rho$</span>.</p><img src="../../assets/dragBeamReconfiguration/ilus.svg" alt="general sketch" width="450"/><h2 id="Dimensionless-analysis"><a class="docs-heading-anchor" href="#Dimensionless-analysis">Dimensionless analysis</a><a id="Dimensionless-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Dimensionless-analysis" title="Permalink"></a></h2><hr/><p>The problem can be studied through the following dimensionless numbers: </p><p class="math-container">\[ c_y = \frac{\rho_f L^3 v_a^2}{16 E I_{zz}}, \qquad \mathcal{R} = \frac{F}{\frac{1}{2}\rho_f L d c_d v_a^2}\]</p><p>where  <span>$F$</span> is the global drag force towards <span>$c_2$</span>, <span>$c_y$</span> is the Cauchy number that describes the ratio between the stiffness of the beam and the flow load and the reconfiguration number <span>$\mathcal{R}$</span> reflects the geometric nonlinear effect by dividing the drag of the flexible beam to that of a rigid one of the same geometry</p><h2 id="Numerical-solution"><a class="docs-heading-anchor" href="#Numerical-solution">Numerical solution</a><a id="Numerical-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-solution" title="Permalink"></a></h2><hr/><p>Before defining the structs, the workspace is cleaned and the ONSAS directory is added:</p><pre><code class="nohighlight hljs">close all, if ~strcmp( getenv(&#39;TESTS_RUN&#39;), &#39;yes&#39;), clear all, end
addpath( genpath( [ pwd &#39;/../../src&#39;] ) ); </code></pre><p>The problem parameters are loaded:</p><pre><code class="nohighlight hljs">[L, d, Izz, E, nu, rhoS, rhoF, nuF, ~, NR, cycd_vec, uydot_vec ] = loadParametersCirc();</code></pre><p>where <span>$\rho_f$</span> and <span>$\rho_s$</span> are the fluid and solid densities respectively, <span>$\nu$</span> is the fluid kinematic viscosity, and  <span>$NR$</span> is the number of load steps (or velocity cases solved):</p><p>The number of elements employed to discretize the beam is:</p><pre><code class="nohighlight hljs">numElements = 10 ;</code></pre><h3 id="MEBI-parameters"><a class="docs-heading-anchor" href="#MEBI-parameters">MEBI parameters</a><a id="MEBI-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#MEBI-parameters" title="Permalink"></a></h3><h3 id="materials"><a class="docs-heading-anchor" href="#materials">materials</a><a id="materials-1"></a><a class="docs-heading-anchor-permalink" href="#materials" title="Permalink"></a></h3><p>Since the example contains only one material and co-rotational strain element so then <code>materials</code> struct is:</p><pre><code class="nohighlight hljs">materials                 = struct()         ;
materials.hyperElasModel  = &#39;1DrotEngStrain&#39; ;
materials.hyperElasParams = [ E nu ]         ;
materials.density         = rhoS             ;</code></pre><h3 id="elements"><a class="docs-heading-anchor" href="#elements">elements</a><a id="elements-1"></a><a class="docs-heading-anchor-permalink" href="#elements" title="Permalink"></a></h3><p>Two different types of elements are considered, node and frames. The nodes will be assigned in the first entry (index <span>$1$</span>) and the beam at the index <span>$2$</span>. The <em>elemType</em> field is then:</p><pre><code class="nohighlight hljs">elements(1).elemType = &#39;node&#39;  ;
elements(2).elemType = &#39;frame&#39; ;</code></pre><p>for the geometries, the node has not geometry to assign (empty array), and frame elements will be set as a circular section with <span>$d$</span> diameter.</p><pre><code class="nohighlight hljs">elements(2).elemCrossSecParams{1,1} = &#39;circle&#39; ;
elements(2).elemCrossSecParams{2,1} = [ d ]    ;</code></pre><p>where the aerodynamic coefficents and the chord vector are set by default for <code>&#39;circle&#39;</code> cross sections type. For the validation case a constant drag coefficients c_d =1.2&quot; is used, this is defined in the <code>&#39;dragCircular&#39;</code> function:   </p><pre><code class="nohighlight hljs">elements(2).dragCoefFunction = &#39;dragCircular&#39; ;</code></pre><p>The geometrical non-linear effects and the aerodynamic stiffness matrix are considered in this case to compute the aerodynamic force vector:</p><pre><code class="nohighlight hljs">elements(2).aeroNumericalParams = {4, true, true} ;</code></pre><h3 id="boundaryConds"><a class="docs-heading-anchor" href="#boundaryConds">boundaryConds</a><a id="boundaryConds-1"></a><a class="docs-heading-anchor-permalink" href="#boundaryConds" title="Permalink"></a></h3><p>Only one welded (6 degrees of freedom are set to zero) boundary condition (BC) is considered:</p><pre><code class="nohighlight hljs">boundaryConds = struct() ;
boundaryConds(1).imposDispDofs = [ 1 2 3 4 5 6 ] ;
boundaryConds(1).imposDispVals = [ 0 0 0 0 0 0 ] ;</code></pre><h3 id="initial-Conditions"><a class="docs-heading-anchor" href="#initial-Conditions">initial Conditions</a><a id="initial-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#initial-Conditions" title="Permalink"></a></h3><p>Any non-homogeneous initial condition (IC) are set for this case, then an empty struct is used:</p><pre><code class="nohighlight hljs">initialConds = struct() ;</code></pre><h3 id="mesh-parameters"><a class="docs-heading-anchor" href="#mesh-parameters">mesh parameters</a><a id="mesh-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#mesh-parameters" title="Permalink"></a></h3><p>The coordinates of the mesh nodes are given by the matrix:</p><pre><code class="nohighlight hljs">mesh = struct() ;
mesh.nodesCoords = [ (0:(numElements))&#39; * L/numElements  zeros(numElements+1,2) ] ;</code></pre><p>The connectivity is introduced using the <em>conecCell</em>. Each entry of the cell contains a vector with the four indexes of the MEBI parameters, followed by the indexes of nodes that compose the element (node connectivity). For didactical purposes each element entry is commented. First the cell is initialized:</p><pre><code class="nohighlight hljs">mesh.conecCell = { } ;</code></pre><p>then the first welded node is defined with material (M) zero since nodes don&#39;t have material, the first element (E) type (the first entry of the <code>elements</code> struct), and (B) is the first entry of the the <code>boundaryConds</code> struct. Finally the node is assigned:</p><pre><code class="nohighlight hljs">mesh.conecCell{ 1, 1 } = [ 0 1 1   1 ] ;</code></pre><p>Next the frame elements MEB parameters are set. The frame material is the first material of <code>materials</code> struct, then <span>$1$</span> is assigned. The second entry of the <code>elements</code> struct correspond to the frame element employed, so <span>$2$</span> is set. Finally no BC is required for this element, then <span>$0$</span> is used.  Consecutive nodes build the element so then the <code>mesh.conecCell</code> is:</p><pre><code class="nohighlight hljs">for i=1:numElements,
  mesh.conecCell{ i+1,1 } = [ 1 2 0   i i+1 ] ;
end</code></pre><h3 id="analysisSettings"><a class="docs-heading-anchor" href="#analysisSettings">analysisSettings</a><a id="analysisSettings-1"></a><a class="docs-heading-anchor-permalink" href="#analysisSettings" title="Permalink"></a></h3><p>The fluid properties are set into <em>fluidProps</em> field into <code>analysisSettings</code> struct. In this field the fluid velocity, viscosity and density are defined, This will apply a external fluid loads according to the quasi-steady theory for each element with aerodynamic coefficients fields into the <code>elements</code> struct. The name of the fluid velocity function located on the same example path is introduced as a string <code>&#39;windVelCircStatic&#39;</code>: </p><pre><code class="nohighlight hljs">analysisSettings = struct() ;
analysisSettings.fluidProps = {rhoF; nuF; &#39;windVelCircStatic&#39;} ;</code></pre><p>since this problem is static, then a N-R method is employed. The time step <code>deltaT</code> is 1 since the time here is an index in the fluid velocity vector <code>uydot_vec</code> untile the length of this vector <code>NR</code> is reached:</p><pre><code class="nohighlight hljs">analysisSettings.deltaT        =   1             ;
analysisSettings.finalTime     =   NR            ;
analysisSettings.methodName    = &#39;newtonRaphson&#39; ;</code></pre><p>Next the maximum number of iterations per load(time) step, the residual force and the displacements tolerances are set to (if null tolerance is set the criterion is not considered): </p><pre><code class="nohighlight hljs">analysisSettings.stopTolDeltau =   0             ;
analysisSettings.stopTolForces =   1e-8          ;
analysisSettings.stopTolIts    =   50            ;</code></pre><h3 id="otherParams"><a class="docs-heading-anchor" href="#otherParams">otherParams</a><a id="otherParams-1"></a><a class="docs-heading-anchor-permalink" href="#otherParams" title="Permalink"></a></h3><p>The name of the problem and vtk format output are selected: </p><pre><code class="nohighlight hljs">otherParams  = struct();
otherParams.problemName = &#39;staticReconfigurationCircleUserDefinedDrag&#39;;
otherParams.plots_format = &#39;vtk&#39; ;</code></pre><h3 id="Case-1:-validation-case-with-constant-c_d-1.2"><a class="docs-heading-anchor" href="#Case-1:-validation-case-with-constant-c_d-1.2">Case 1: validation case with constant <span>$c_d = 1.2$</span></a><a id="Case-1:-validation-case-with-constant-c_d-1.2-1"></a><a class="docs-heading-anchor-permalink" href="#Case-1:-validation-case-with-constant-c_d-1.2" title="Permalink"></a></h3><p>The ONSAS software is executed for the parameters above defined and the displacement solution of each load(time) step is saved in <code>matUsCase1</code>matrix:</p><p>The reaction forces at <span>$x=0$</span> are stored  in the following vector and declaring a global variable:</p><pre><code class="nohighlight hljs">global globalReactionForces
globalReactionForces = zeros(6*analysisSettings.finalTime, 1) ;</code></pre><p>The node index where the reaction forces are computed is:</p><pre><code class="nohighlight hljs">global glboalNodeReactionForces
glboalNodeReactionForces = 1 ;</code></pre><h3 id="Numeric-solution"><a class="docs-heading-anchor" href="#Numeric-solution">Numeric solution</a><a id="Numeric-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Numeric-solution" title="Permalink"></a></h3><pre><code class="nohighlight hljs">[matUsCase1] = ONSAS( materials, elements, boundaryConds, initialConds, mesh, analysisSettings, otherParams ) ;</code></pre><h2 id="Verification"><a class="docs-heading-anchor" href="#Verification">Verification</a><a id="Verification-1"></a><a class="docs-heading-anchor-permalink" href="#Verification" title="Permalink"></a></h2><hr/><p>The numerical solution is extracted. First the reference coordinaes</p><pre><code class="nohighlight hljs">xref = mesh.nodesCoords(:,1) ;
yref = mesh.nodesCoords(:,2) ;
zref = mesh.nodesCoords(:,3) ;</code></pre><p>Then the values of <span>$R$</span> and <span>$C_y C_d$</span> are computed :</p><pre><code class="nohighlight hljs">numLoadSteps = size(matUsCase1, 2) ;
timeVec = linspace(0,analysisSettings.finalTime, numLoadSteps) ;
% initialize vectors
Cy = zeros(numLoadSteps-1, 1)                 ;
R  = zeros(numLoadSteps-1, 1)                 ;
C_d = feval( elements(2).dragCoefFunction, 0 , 0) ;
% fill them
for windVelStep = 1:numLoadSteps - 1
    % Compute dimensionless magnitudes 
    windVel         = feval( analysisSettings.fluidProps{3,:}, 0, timeVec(windVelStep + 1 ) ) ;
    normWindVel     = norm( windVel )                                                         ;
    dirWindVel      = windVel / normWindVel                                                   ;
    Cy(windVelStep) =  1/2 * rhoF * normWindVel^2 * (L)^3 *d / (E*Izz)                        ;

    % numeric drag 
    FReaction = globalReactionForces((windVelStep-1)*6 + 1: windVelStep*6) ;
    FDragi = FReaction(3)                                                  ;    
    FDRef  = 1/2 * rhoF * normWindVel^2 * C_d * d * L ;
    R(windVelStep) =  abs(FDragi)/(FDRef )            ;

end</code></pre><h3 id="Gosselin-et.Al-2010-solution"><a class="docs-heading-anchor" href="#Gosselin-et.Al-2010-solution">Gosselin et.Al 2010 solution</a><a id="Gosselin-et.Al-2010-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Gosselin-et.Al-2010-solution" title="Permalink"></a></h3><pre><code class="nohighlight hljs">% resudrag (cycd, R) and def wich contains de deformed configuration for 10^i cycyd values: 
base_dir=&#39;&#39;;
if strcmp( getenv(&#39;TESTS_RUN&#39;),&#39;yes&#39;) &amp;&amp; isfolder(&#39;examples&#39;),
  base_dir=[&#39;.&#39; filesep &#39;examples&#39; filesep &#39;dragBeamReconfiguration&#39; filesep];
end
load( [base_dir &#39;Gosselin2010_data.mat&#39;], &#39;def&#39;, &#39;resudrag&#39;)</code></pre><h3 id="Validation-plots"><a class="docs-heading-anchor" href="#Validation-plots">Validation plots</a><a id="Validation-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Validation-plots" title="Permalink"></a></h3><p>The plot parameters are:</p><pre><code class="nohighlight hljs">lw = 4 ; ms = 8 ;
axislw = 1  ; axisFontSize = 20 ; legendFontSize = 15 ; curveFontSize = 15 ;
Gline = &#39;k-&#39;; ONSASline = &#39;bo&#39;  ;  ONSASlineBuiltInDrag = &#39;rx&#39; ;   
folderPathFigs = &#39;./output/figs/&#39; ;
mkdir(folderPathFigs) ;</code></pre><p>The modified Cauchy number vs R is plotted:  </p><pre><code class="nohighlight hljs">fig1 = figure(1) ;
loglog(C_d*Cy       , R             , ONSASline , &#39;linewidth&#39;, lw, &#39;markersize&#39;, ms ) ;
hold on
loglog(resudrag(:,1), resudrag(:,2) , Gline     , &#39;linewidth&#39;, lw, &#39;markersize&#39;, ms ) ;
% add legend
legend(&#39;ONSAS&#39;, &#39;Gosselin2010&#39;)
% set labels legend
labx=xlabel(&#39; c_y*c_d &#39;);    laby=ylabel(&#39;R&#39;);
set(legend, &#39;linewidth&#39;, axislw, &#39;fontsize&#39;, legendFontSize, &#39;location&#39;,&#39;eastOutside&#39; ) ;
% set fonts
set(gca, &#39;linewidth&#39;, axislw, &#39;fontsize&#39;, curveFontSize ) ;
set(labx, &#39;FontSize&#39;, axisFontSize); set(laby, &#39;FontSize&#39;, axisFontSize) ;
grid on
if length(getenv(&#39;TESTS_RUN&#39;)) &gt; 0 &amp;&amp; strcmp( getenv(&#39;TESTS_RUN&#39;), &#39;yes&#39;)
  fprintf(&#39;\ngenerating output png for docs.\n&#39;)
  figure(1)
  print(&#39;output/RvsCyCd.png&#39;,&#39;-dpng&#39;)
else
  fprintf(&#39;\n === NOT in docs workflow. ===\n&#39;)
end</code></pre><p>Deformed configurations for different cauchy numbers  </p><pre><code class="nohighlight hljs">fig3 = figure(3) ;
hold on
% plot reference configuration
plot(xref, yref  , &#39;k--&#39; , &#39;linewidth&#39;, lw, &#39;markersize&#39;, ms   );
% add ficitcius plots for the legend
plot(0, 0,  ONSASline    , &#39;linewidth&#39;, lw, &#39;markersize&#39;, ms );
plot(0, 0,  ONSASlineBuiltInDrag    , &#39;linewidth&#39;, lw, &#39;markersize&#39;, ms );
% plot deformed configurations for different fluid load steps
for nr = 1:analysisSettings.finalTime 
  % Numerical deformed coordinates solution
  xdef = xref + matUsCase1(1:6:end,nr+1) ;
  ydef = yref + matUsCase1(3:6:end,nr+1) ;
  zdef = zref + matUsCase1(5:6:end,nr+1) ;
  thetaXdef = matUsCase1(2:6:end,nr+1)   ;
  thetaYdef = matUsCase1(4:6:end,nr+1)   ;
  thetaZdef = matUsCase1(6:6:end,nr+1)   ;
  % Gosselin deformed coordinates solution
  xdefG = def(1,:,nr)               ;
  ydefG = -def(2,:,nr)              ;
  % Plot 
  plot(xdef ,  ydef,  ONSASline, &#39;linewidth&#39;, lw, &#39;markersize&#39;, ms );
  plot(xdefG, ydefG,  Gline    , &#39;linewidth&#39;, lw, &#39;markersize&#39;, ms );
end</code></pre><h3 id="Verification-boolean"><a class="docs-heading-anchor" href="#Verification-boolean">Verification boolean</a><a id="Verification-boolean-1"></a><a class="docs-heading-anchor-permalink" href="#Verification-boolean" title="Permalink"></a></h3><pre><code class="nohighlight hljs">% The verification boolean is computed as for the deformed configurations and the cycd curve
% deformed coordinates dif norm
vecDifDeform =  [ norm( ydef - ydefG(1:numElements*10:end)&#39;) ;...
                  norm( xdef - xdefG(1:numElements*10:end)&#39;) ] ;

% verification boolean deformed 
verifBooleanDef =  vecDifDeform &lt;=  2e-2 * L ;
% cycd vs R verification boolean is: 
verifBooleanR = abs(R(end) - resudrag(end,2) ) &lt;  5e-3 ;
% The example verifboolean is:
verifBoolean = verifBooleanR &amp;&amp; all(verifBooleanDef)</code></pre><img src="../../assets/generated/RvsCyCd.png" alt="plot check deformed configurations" width="500"/><h3 id="Case-2:-case-with-drag-coefficient-formula-proposed-in-[this-reference](https://ascelibrary.org/doi/10.1061/%28ASCE%29HY.1943-7900.0000722)"><a class="docs-heading-anchor" href="#Case-2:-case-with-drag-coefficient-formula-proposed-in-[this-reference](https://ascelibrary.org/doi/10.1061/%28ASCE%29HY.1943-7900.0000722)">Case 2: case with drag coefficient formula proposed in <a href="https://ascelibrary.org/doi/10.1061/%28ASCE%29HY.1943-7900.0000722">this reference</a></a><a id="Case-2:-case-with-drag-coefficient-formula-proposed-in-[this-reference](https://ascelibrary.org/doi/10.1061/%28ASCE%29HY.1943-7900.0000722)-1"></a><a class="docs-heading-anchor-permalink" href="#Case-2:-case-with-drag-coefficient-formula-proposed-in-[this-reference](https://ascelibrary.org/doi/10.1061/%28ASCE%29HY.1943-7900.0000722)" title="Permalink"></a></h3><p>Once <code>_elemCrossSecParams_</code> is defined in the <code>elements</code> struct then the drag lift and pitch moment are defined with bluit-in functions. As consequence if we want to use the default drag coefficient the <code>dragCoefFunction</code> field must be set:</p><pre><code class="nohighlight hljs">elements(2).dragCoefFunction = [];</code></pre><p>moreover the drag formulation in <a href="https://ascelibrary.org/doi/10.1061/%28ASCE%29HY.1943-7900.0000722">this reference</a> is valid with <span>$Re &lt; 2$</span> x <span>$10^5$</span>. Then the final load step, which is equivalent to the index in the velocity vector <code>uydot_vec</code>, is set to 5: </p><pre><code class="nohighlight hljs">analysisSettings.finalTime = NR - 2 ;</code></pre><h3 id="otherParams-2"><a class="docs-heading-anchor" href="#otherParams-2">otherParams</a><a class="docs-heading-anchor-permalink" href="#otherParams-2" title="Permalink"></a></h3><p>The name of the problem and vtk format output are selected: </p><pre><code class="nohighlight hljs">otherParams  = struct();
otherParams.problemName = &#39;staticReconfigurationCircleBuiltInDrag&#39;;</code></pre><h3 id="Numeric-solution-2"><a class="docs-heading-anchor" href="#Numeric-solution-2">Numeric solution</a><a class="docs-heading-anchor-permalink" href="#Numeric-solution-2" title="Permalink"></a></h3><pre><code class="nohighlight hljs">[matUsCase2] = ONSAS( materials, elements, boundaryConds, initialConds, mesh, analysisSettings, otherParams ) ;</code></pre><p>Deformed configurations for different cauchy numbers  </p><pre><code class="nohighlight hljs">for nr = 1:analysisSettings.finalTime 
  % Numerical deformed coordinates solution
  xdefCase2 = xref + matUsCase2(1:6:end,nr+1) ;
  ydefCase2 = yref + matUsCase2(3:6:end,nr+1) ;
  zdefCase2 = zref + matUsCase2(5:6:end,nr+1) ;
  thetaXdefCase2 = matUsCase2(2:6:end,nr+1)   ;
  thetaYdefCase2 = matUsCase2(4:6:end,nr+1)   ;
  thetaZdefCase2 = matUsCase2(6:6:end,nr+1)   ;
  % Plot 
  plot(xdefCase2 ,  ydefCase2,  ONSASlineBuiltInDrag, &#39;linewidth&#39;, lw, &#39;markersize&#39;, ms );
end
% add legend
legend(&#39;Gosselin2010(cd = 1.2)&#39;, &#39;ONSAS(cd = 1.2)&#39;,&#39;ONSAS(Built-in c_d)&#39;)
% add legends and labels
labx=xlabel(&#39;x [m]&#39;);    laby=ylabel(&#39;y [m]&#39;);
% set fonts
set(legend, &#39;linewidth&#39;, axislw, &#39;fontsize&#39;, legendFontSize, &#39;location&#39;,&#39;eastOutside&#39; ) ;
set(gca, &#39;linewidth&#39;, axislw, &#39;fontsize&#39;, curveFontSize ) ;
set(labx, &#39;FontSize&#39;, axisFontSize); set(laby, &#39;FontSize&#39;, axisFontSize) ;
grid on
axis equal
% save fig
namefig3 = strcat(folderPathFigs, &#39;xy.png&#39;) ;
if length(getenv(&#39;TESTS_RUN&#39;)) &gt; 0 &amp;&amp; strcmp( getenv(&#39;TESTS_RUN&#39;), &#39;yes&#39;)
  fprintf(&#39;\ngenerating output png for docs.\n&#39;)
  figure(3)
  print(&#39;output/defPlots.png&#39;,&#39;-dpng&#39;)
else
  fprintf(&#39;\n === NOT in docs workflow. ===\n&#39;)
end</code></pre><img src="../../assets/generated/defPlots.png" alt="plot check deformed configurations" width="500"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ringPlaneStrain/">« Plane strain ring</a><a class="docs-footer-nextpage" href="../simplePropeller/">Propeller model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 11 August 2023 20:47">Friday 11 August 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
